#+TITLE: Editmarks (Track Changes)
#+AUTHOR: Scimax VS Code Team
#+DATE: 2026-01-13
#+STARTUP: overview
#+OPTIONS: toc:2 num:t H:4
#+TODO: âš ï¸ ðŸ‘€ | âœ…
*Keybinding Note:* This extension uses Emacs-style keybindings where Ctrl is used on all platforms (not Cmd on Mac), except where explicitly noted. Mac alternatives are shown as Cmd where applicable.

* âš ï¸ Introduction

Editmarks is a track changes system for scientific writing and collaborative editing in VS Code. Inspired by scimax-editmarks from Emacs Scimax, it provides a lightweight markup syntax for tracking insertions, deletions, comments, and typo corrections directly in your documents.

Unlike traditional track changes systems that rely on binary formats or external tools, editmarks uses plain text markup that works seamlessly across org-mode, Markdown, and LaTeX files. Changes remain visible and editable as plain text, making them perfect for version control systems like Git.

** âš ï¸ Key Features

- *Plain text markup*: Changes are visible in any text editor
- *Language-agnostic*: Works in org-mode, Markdown, LaTeX, and plain text
- *Four mark types*: Insertions, deletions, comments, and typo corrections
- *Visual highlighting*: Color-coded decorations for easy identification
- *Quick navigation*: Jump between marks with keyboard shortcuts
- *Batch operations*: Accept or reject all changes at once
- *Hover actions*: Quick accept/reject from hover tooltips
- *Summary view*: Overview of all changes in the document

** âš ï¸ Use Cases

1. *Document review*: Mark suggested changes when reviewing a colleague's work
2. *Collaborative editing*: Track your edits when working on shared documents
3. *Self-revision*: Keep track of your own changes during editing sessions
4. *Teaching and feedback*: Provide inline suggestions to students or mentees
5. *Version control*: Complement Git commits with inline change tracking

* âš ï¸ Markup Syntax

Editmarks supports two markup formats to maximize compatibility:

** âš ï¸ Universal Format (Recommended)

The universal format works in all document types:

#+begin_example
@@+inserted text+@@       # Insertion
@@-deleted text-@@        # Deletion
@@>comment text<@@        # Comment
@@~old text|new text~@@   # Typo correction
#+end_example

** âš ï¸ CriticMarkup Format (Alternative)

An alternative format inspired by CriticMarkup:

#+begin_example
{++inserted text++}       # Insertion
{--deleted text--}        # Deletion
{>>comment text<<}        # Comment
{~~old text~>new text~~}  # Typo correction
#+end_example

Both formats are recognized and rendered identically. Choose whichever you prefer or is required by your workflow.

* âš ï¸ Types of Editmarks

** âš ï¸ Insertion

*Purpose*: Mark text that should be added to the document.

*Syntax*: @@+text+@@ or {++text++}

*Visual appearance*: Green background with green border

*Example*:
#+begin_example
The quick brown fox @@+gracefully+@@ jumps over the lazy dog.
#+end_example

*When to use*:
- Suggesting new content
- Adding missing words or phrases
- Inserting clarifications or examples

** âš ï¸ Deletion

*Purpose*: Mark text that should be removed from the document.

*Syntax*: @@-text-@@ or {--text--}

*Visual appearance*: Red background with red border and strikethrough text

*Example*:
#+begin_example
The quick brown @@-very-@@ fox jumps over the lazy dog.
#+end_example

*When to use*:
- Removing redundant text
- Deleting incorrect information
- Suggesting text removal during review

** âš ï¸ Comment

*Purpose*: Add inline comments or notes without changing the document text.

*Syntax*: @@>comment<@@ or {>>comment<<}

*Visual appearance*: Yellow background with yellow border and italic text

*Example*:
#+begin_example
The results were statistically significant @@>verify p-value<@@.
#+end_example

*When to use*:
- Asking questions about the text
- Leaving notes for the author
- Marking sections that need attention
- Providing context for other changes

** âš ï¸ Typo Correction

*Purpose*: Mark a typo or error and suggest the correct text.

*Syntax*: @@~wrong|correct~@@ or {~~wrong~>correct~~}

*Visual appearance*: Orange background with orange border

*Example*:
#+begin_example
The experment @@~experment|experiment~@@ was successful.
#+end_example

*When to use*:
- Correcting spelling mistakes
- Fixing grammatical errors
- Suggesting better word choices
- Standardizing terminology

* âš ï¸ Creating Editmarks

** âš ï¸ Mark Insertion

*Command*: Scimax: Mark Insertion
*Keybinding*: Ctrl+C e i (same on Mac)

*Behavior*:
1. *With text selected*: Wraps selection with insertion markup
2. *Without selection*: Prompts for text to insert

*Example workflow*:
1. Select "quickly" in your text (or place cursor where text should be inserted)
2. Press Ctrl+C e i
3. If no selection, type the text to insert
4. Result: @@+quickly+@@

** âš ï¸ Mark Deletion

*Command*: Scimax: Mark Deletion
*Keybinding*: Ctrl+C e d

*Behavior*:
- Requires text selection
- Wraps selected text with deletion markup

*Example workflow*:
1. Select "very" in your text
2. Press Ctrl+C e d
3. Result: @@-very-@@

** âš ï¸ Insert Comment

*Command*: Scimax: Insert Edit Comment
*Keybinding*: Ctrl+C e c

*Behavior*:
1. *With text selected*: Uses selection as comment text
2. *Without selection*: Prompts for comment

*Example workflow*:
1. Place cursor at the relevant location
2. Press Ctrl+C e c
3. Type: "Check this citation"
4. Result: @@>Check this citation<@@

** âš ï¸ Mark Typo Correction

*Command*: Scimax: Mark Typo Correction
*Keybinding*: Ctrl+C e t

*Behavior*:
- Requires text selection (the incorrect text)
- Prompts for the correct text
- Creates a typo mark showing oldâ†’new

*Example workflow*:
1. Select "teh" in your text
2. Press Ctrl+C e t
3. Type: "the"
4. Result: @@~teh|the~@@

* âš ï¸ Reviewing and Processing Editmarks

** âš ï¸ Accept Edit Mark

*Command*: Scimax: Accept Edit Mark
*Keybinding*: Ctrl+C e a

Accepts the editmark at the cursor position:
- *Insertion*: Keeps the inserted text, removes markup (@@+text+@@ â†’ text)
- *Deletion*: Removes the deleted text entirely (@@-text-@@ â†’ empty)
- *Comment*: Removes the comment (@@>text<@@ â†’ empty)
- *Typo*: Applies the correction (@@~old|new~@@ â†’ new)

*Example*:
#+begin_example
Before: The quick @@+brown+@@ fox
After:  The quick brown fox
#+end_example

** âš ï¸ Reject Edit Mark

*Command*: Scimax: Reject Edit Mark
*Keybinding*: Ctrl+C e r

Rejects the editmark at the cursor position:
- *Insertion*: Removes the inserted text (@@+text+@@ â†’ empty)
- *Deletion*: Keeps the original text (@@-text-@@ â†’ text)
- *Comment*: Removes the comment (@@>text<@@ â†’ empty)
- *Typo*: Keeps the original text (@@~old|new~@@ â†’ old)

*Example*:
#+begin_example
Before: The quick @@+brown+@@ fox
After:  The quick fox
#+end_example

** âš ï¸ Accept All Edit Marks

*Command*: Scimax: Accept All Edit Marks

Accepts all editmarks in the current document:
1. Shows confirmation dialog with count
2. Processes all marks from bottom to top
3. Displays success message

*Use case*: After reviewing all changes and deciding to incorporate them all.

** âš ï¸ Reject All Edit Marks

*Command*: Scimax: Reject All Edit Marks

Rejects all editmarks in the current document:
1. Shows confirmation dialog with count
2. Processes all marks from bottom to top
3. Displays success message

*Use case*: When you want to discard all suggested changes and revert to the original text.

** âš ï¸ Hover Actions

Position your cursor over any editmark to see a hover tooltip with:
- Mark type and content
- Quick action links to accept or reject
- For typos: Shows old â†’ new transformation

This provides a quick way to review and act on individual changes without remembering keybindings.

* âš ï¸ Navigation

** âš ï¸ Next Edit Mark

*Command*: Scimax: Next Edit Mark
*Keybinding*: Ctrl+C e ]

Moves the cursor to the next editmark in the document:
- Wraps around to the first mark if at the end
- Centers the mark in the viewport
- Useful for systematic review

** âš ï¸ Previous Edit Mark

*Command*: Scimax: Previous Edit Mark
*Keybinding*: Ctrl+C e [

Moves the cursor to the previous editmark:
- Wraps around to the last mark if at the beginning
- Centers the mark in the viewport

** âš ï¸ Keyboard Navigation Pattern

The bracket keys ([ and ]) create an intuitive navigation pattern:
- Ctrl+C e ] â†’ next (forward, like closing bracket points right)
- Ctrl+C e [ â†’ previous (backward, like opening bracket points left)

* âš ï¸ Summary View

*Command*: Scimax: Show Edit Marks Summary
*Keybinding*: Ctrl+C e s

Opens a quick pick menu showing:
1. *Summary statistics*: Total count and breakdown by type
2. *Individual marks*: List of all editmarks with:
   - Icon indicating mark type
   - Content preview (first 40 characters)
   - Line number

*Features*:
- Searchable: Type to filter marks
- Click to navigate: Select a mark to jump to it
- Color-coded: Visual distinction between mark types

*Example output*:
#+begin_example
Summary
â”œâ”€â”€ Insertions: 3 (Green)
â”œâ”€â”€ Deletions: 2 (Red)
â”œâ”€â”€ Comments: 1 (Yellow)
â””â”€â”€ Typos: 2 (Orange)

ðŸ“ gracefully                    Line 12
âŒ very                          Line 15
ðŸ’¬ Check this citation           Line 23
âœï¸  teh â†’ the                    Line 34
...
#+end_example

* âš ï¸ Visual Appearance

Editmarks are rendered with distinctive decorations:

| Type      | Background Color | Border           | Text Style   | Icon |
|-----------+------------------+------------------+--------------+------|
| Insertion | Light green      | Green            | Normal       | ðŸ“   |
| Deletion  | Light red        | Red              | Strikethrough| âŒ   |
| Comment   | Light yellow     | Yellow           | Italic       | ðŸ’¬   |
| Typo      | Light orange     | Orange           | Normal       | âœï¸   |

All decorations include:
- Semi-transparent background (20% opacity)
- Solid border for clear delimitation
- 2px border radius for rounded corners

* âš ï¸ Complete Command Reference

** âš ï¸ Insertion Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.insertion  | Ctrl+C e i  | Mark text as insertion     |

** âš ï¸ Deletion Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.deletion   | Ctrl+C e d  | Mark text for deletion     |

** âš ï¸ Comment Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.comment    | Ctrl+C e c  | Insert edit comment        |

** âš ï¸ Typo Correction Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.typo       | Ctrl+C e t  | Mark typo correction       |

** âš ï¸ Review Commands

| Command                      | Keybinding  | Description                |
|------------------------------+-------------+----------------------------|
| scimax.editmarks.accept      | Ctrl+C e a  | Accept mark at cursor      |
| scimax.editmarks.reject      | Ctrl+C e r  | Reject mark at cursor      |
| scimax.editmarks.acceptAll   | (none)      | Accept all marks           |
| scimax.editmarks.rejectAll   | (none)      | Reject all marks           |

** âš ï¸ Navigation Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.next       | Ctrl+C e ]  | Jump to next mark          |
| scimax.editmarks.prev       | Ctrl+C e [  | Jump to previous mark      |

** âš ï¸ Utility Commands

| Command                     | Keybinding  | Description                |
|-----------------------------+-------------+----------------------------|
| scimax.editmarks.summary    | Ctrl+C e s  | Show all marks summary     |

* âš ï¸ Keybinding Pattern

All editmarks keybindings follow the pattern Ctrl+C e <letter>:

- Ctrl+C e â†’ Editmarks prefix
- i â†’ Insertion
- d â†’ Deletion
- c â†’ Comment
- t â†’ Typo
- a â†’ Accept
- r â†’ Reject
- s â†’ Summary
- [ â†’ Previous
- ] â†’ Next

This consistent pattern makes the commands easy to remember and discover.

* âš ï¸ Typical Workflows

** âš ï¸ Workflow 1: Peer Review

*Scenario*: You're reviewing a colleague's research paper draft.

1. *Open the document* in VS Code
2. *Read through* and identify areas needing changes
3. *Mark suggestions*:
   - Select unclear text, press Ctrl+C e c, add comment: "Can you clarify this?"
   - Select redundant phrase, press Ctrl+C e d to mark for deletion
   - Place cursor after a sentence, press Ctrl+C e i, suggest additional text
4. *Add typo corrections*:
   - Select "occured", press Ctrl+C e t, type "occurred"
5. *Save the document* and send back to colleague
6. *Colleague reviews* using Ctrl+C e ] to navigate between marks
7. *Colleague processes* each mark:
   - Press Ctrl+C e a to accept
   - Press Ctrl+C e r to reject
   - Or use hover tooltips for quick decisions
8. *Save final version* with all changes resolved

** âš ï¸ Workflow 2: Self-Editing

*Scenario*: You're revising your own manuscript and want to track changes.

1. *Enable editmarks mode* (always on - no toggle needed)
2. *As you edit*, use editmarks instead of direct changes:
   - Instead of deleting text: select it and Ctrl+C e d
   - Instead of adding text: Ctrl+C e i to insert
   - Mark uncertainties: Ctrl+C e c with "TODO: verify this"
3. *Take a break* - changes are preserved in plain text
4. *Review later*:
   - Open document and press Ctrl+C e s for summary
   - See all your pending changes at a glance
5. *Process systematically*:
   - Use Ctrl+C e ] to jump between marks
   - Accept or reject each change thoughtfully
6. *Commit to version control* with clear change history

** âš ï¸ Workflow 3: Collaborative Writing

*Scenario*: Multiple authors working on a shared document in a Git repository.

1. *Author A* makes initial draft
2. *Author B* checks out the branch and adds suggestions:
   #+begin_example
   The analysis @@>Author B: should we mention the control group here?<@@
   showed @@+significant+@@ results.
   #+end_example
3. *Author C* adds more changes:
   #+begin_example
   The analysis @@>Author B: should we mention the control group here?<@@
   showed @@+significant+@@ results @@>(Author C: p < 0.01)+@@.
   #+end_example
4. *Authors meet* to review:
   - Open document and press Ctrl+C e s
   - Discuss each mark in the summary
   - Navigate with Ctrl+C e ] / Ctrl+C e [
5. *Accept/reject collaboratively*
6. *Commit final version* to Git with all changes incorporated

** âš ï¸ Workflow 4: Student Feedback

*Scenario*: Providing detailed feedback on student writing.

1. *Open student's submission*
2. *Read through once* without marking
3. *Second pass - mark issues*:
   - Grammar/spelling: Use Ctrl+C e t for typos
   - Clarity issues: Ctrl+C e c with specific questions
   - Structural problems: Ctrl+C e i to suggest additional sentences
   - Verbose sections: Ctrl+C e d with comments explaining why
4. *Add pedagogical comments*:
   #+begin_example
   @@>Good use of evidence here! Consider adding more analysis of what
   this means for your thesis.<@@
   #+end_example
5. *Generate summary report*:
   - Press Ctrl+C e s
   - Show student: "You have 5 typos, 3 clarity issues, 2 structural suggestions"
6. *Student processes feedback*:
   - Uses navigation to review each mark
   - Reads hover tooltips for quick context
   - Accepts corrections, addresses comments
   - Removes comment marks after addressing them

** âš ï¸ Workflow 5: Document Review Cycle

*Scenario*: Multiple rounds of review with stakeholder feedback.

*Round 1 - Reviewer marks changes*:
#+begin_example
The project will @@+likely+@@ be completed @@-on time-@@ @@+ahead of schedule+@@.
@@>Reviewer: Source for this claim?<@@
#+end_example

*Round 2 - Author responds*:
#+begin_example
The project will @@+likely+@@ be completed @@+ahead of schedule+@@.
@@>Author: Added reference below. See Smith et al. 2025<@@
[ref added here]
#+end_example

*Round 3 - Final acceptance*:
1. Reviewer opens document
2. Presses Ctrl+C e s to see all outstanding marks
3. Navigates with Ctrl+C e ] through each change
4. Presses Ctrl+C e a to accept all approved changes
5. Final document is clean and ready for publication

* âš ï¸ Best Practices

** âš ï¸ Do's

1. *Use descriptive comments*: Instead of @@>fix this<@@, write @@>fix grammar: subject-verb agreement<@@
2. *Be specific with insertions*: Show exactly what you're suggesting
3. *One change per mark*: Don't combine multiple edits in one mark
4. *Review systematically*: Use navigation commands to ensure you don't miss any marks
5. *Preserve marks in Git*: Commit documents with editmarks to track review history
6. *Use hover tooltips*: Quick way to remind yourself what each mark does

** âš ï¸ Don'ts

1. *Don't nest editmarks*: Avoid @@+text @@-with-@@ nesting+@@ - it's confusing
2. *Don't mix formats randomly*: Pick either universal or CriticMarkup and stick with it
3. *Don't leave marks indefinitely*: Process them regularly to keep documents clean
4. *Don't delete marks manually*: Use accept/reject commands to ensure proper processing
5. *Don't use for version control*: Editmarks complement Git but don't replace it

** âš ï¸ Tips

- *Quick review*: Use Ctrl+C e s at the start of each editing session to see pending changes
- *Batch processing*: For documents with many trivial changes, use "Accept All" after review
- *Comments as TODO*: Use comment marks as inline TODO items during writing
- *Color awareness*: Learn to recognize mark types by color for faster visual scanning
- *Git integration*: Create commits after processing editmarks with descriptive messages
- *Keyboard efficiency*: The navigation keys ([ and ]) combined with a/r enable fast review

* âš ï¸ Integration with Other Features

** âš ï¸ Source Blocks

Editmarks work inside source blocks:

#+begin_src python
def calculate(x):
    return x * @@+2+@@ @@-3-@@  @@>why change the multiplier?<@@
#+end_src

This is useful when reviewing code snippets in documentation or educational materials.

** âš ï¸ Tables

Use editmarks in table cells:

| Item   | Original  | Revised        | Notes                  |
|--------+-----------+----------------+------------------------|
| Budget | @@-$100K-@@   | @@+$120K+@@      | @@>approved by CFO<@@    |
| Time   | 6 months  | @@+8 months+@@   | @@>realistic estimate<@@ |

** âš ï¸ Export Compatibility

When exporting documents (HTML, LaTeX, PDF):
- *Unprocessed marks* appear in the exported output
- *Process marks first* before final export
- Or use regex to strip marks during export if needed

** âš ï¸ Version Control

Editmarks are perfect for version control workflows:

#+begin_src bash
# Add document with editmarks
git add manuscript.org

# Commit with descriptive message
git commit -m "Add reviewer feedback as editmarks"

# Later, after processing
git add manuscript.org
git commit -m "Incorporate reviewer suggestions"
#+end_src

The diff shows both the markup and the final changes, providing complete review history.

* âš ï¸ Troubleshooting

** âš ï¸ Editmarks Not Showing

*Problem*: Markup is visible but not decorated with colors.

*Solutions*:
1. Check that you're in a supported file (any text file works)
2. Reload window: Ctrl+Shift+P â†’ "Developer: Reload Window"
3. Verify syntax: Ensure markup is exactly correct (e.g., @@+text+@@ not @@+ text +@@)

** âš ï¸ Navigation Not Working

*Problem*: Ctrl+C e ] doesn't jump to next mark.

*Solutions*:
1. Verify editmarks exist: Press Ctrl+C e s to see summary
2. Ensure cursor is in the editor window
3. Check keybinding conflicts: File â†’ Preferences â†’ Keyboard Shortcuts

** âš ï¸ Accept/Reject Not Working

*Problem*: Nothing happens when pressing Ctrl+C e a.

*Solutions*:
1. Position cursor *inside* the editmark (between the markup symbols)
2. Hover over the mark to see the tooltip - if visible, cursor is positioned correctly
3. Check that the editmark syntax is valid

** âš ï¸ Nested Marks Issue

*Problem*: Marks inside other marks behave unexpectedly.

*Solution*: Don't nest editmarks. Instead, process the inner mark first, then add the outer mark.

** âš ï¸ Performance with Many Marks

*Problem*: Editor becomes slow with hundreds of editmarks.

*Solutions*:
1. Process marks in batches (accept/reject groups of related changes)
2. Use "Accept All" or "Reject All" for bulk processing
3. Split large documents into smaller files

* âš ï¸ FAQ

** âš ï¸ Q: Can I customize the colors?

A: Currently, colors are fixed (green for insertion, red for deletion, yellow for comments, orange for typos). Custom theme support may be added in future versions.

** âš ï¸ Q: Do editmarks work in any file type?

A: Yes! Editmarks work in any text file: .org, .md, .tex, .txt, .py, etc. The markup is plain text.

** âš ï¸ Q: Can I export documents with editmarks?

A: Yes, but the markup will appear in the exported output. It's recommended to process all editmarks before final export.

** âš ï¸ Q: How do I see who made which mark?

A: Editmarks don't automatically track authors. Add author names manually in comments:
#+begin_example
@@>(Author: John Doe) This needs clarification<@@
#+end_example

** âš ï¸ Q: Can I use editmarks with Word documents?

A: No, editmarks require plain text files. Convert Word documents to Markdown or use Word's built-in track changes.

** âš ï¸ Q: Do editmarks interfere with syntax highlighting?

A: No, they're implemented as decorations that overlay the text without modifying syntax highlighting.

** âš ï¸ Q: Can I undo an accept/reject action?

A: Yes, use VS Code's regular undo (Ctrl+Z) immediately after accepting or rejecting a mark.

** âš ï¸ Q: Are editmarks saved with the file?

A: Yes! Editmarks are plain text markup, so they're saved as part of the document content.

** âš ï¸ Q: Can I search for editmarks?

A: Yes, use regular search (Ctrl+F) for @@+ or {++ to find all insertions, etc. Or use Ctrl+C e s for the summary view.

* âš ï¸ Related Features

- *Source Blocks*: See [[file:source-blocks.org][Source Blocks documentation]] for code execution
- *Export*: See [[file:export.org][Export documentation]] for converting documents with editmarks
- *Document Structure*: See [[file:document-structure.org][Document Structure documentation]] for heading navigation
- *Tables*: See [[file:tables.org][Tables documentation]] for working with tables containing editmarks

* âš ï¸ Conclusion

Editmarks provide a powerful, plain-text approach to track changes that integrates seamlessly with modern developer workflows. By using simple markup instead of complex binary formats, editmarks offer:

- *Transparency*: Changes are always visible and readable
- *Portability*: Works across editors and platforms
- *Version control*: Perfect for Git-based collaboration
- *Flexibility*: Use as much or as little as you need

Whether you're reviewing papers, collaborating on documentation, or tracking your own revisions, editmarks offer a lightweight yet powerful solution for managing document changes.

Start using editmarks today:
1. Open any document
2. Press Ctrl+C e i to insert your first mark
3. Press Ctrl+C e s to see the summary
4. Navigate with Ctrl+C e ] and Ctrl+C e [
5. Accept or reject with Ctrl+C e a and Ctrl+C e r

Happy editing!
