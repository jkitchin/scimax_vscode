#+TITLE: LaTeX Preview
#+AUTHOR: Scimax VS Code Team
#+DATE: 2026-01-13
#+STARTUP: overview
#+OPTIONS: toc:2 num:t H:4
#+TODO: ‚ö†Ô∏è üëÄ | ‚úÖ

* Introduction

The Scimax VS Code extension provides comprehensive LaTeX preview functionality for org-mode documents, enabling inline rendering of mathematical equations and formulas. This feature brings publication-quality mathematics directly into your editing workflow without requiring manual compilation or external viewers.

** What is LaTeX Preview?

LaTeX preview is a system that automatically compiles and renders LaTeX mathematical expressions as images when you hover over them in your org-mode documents. This provides instant visual feedback for complex equations, matrices, and mathematical notation.

** Key Features

- *Hover Preview*: Rendered equations appear in tooltips when hovering over LaTeX code
- *Multiple Syntax Styles*: Support for both dollar-sign and backslash delimiters
- *Dark Mode Aware*: Automatically adjusts rendering for light and dark themes
- *Smart Caching*: Previously rendered equations are cached for instant display
- *Document Settings*: Use custom LaTeX packages and preambles
- *Equation Numbering*: Automatic numbering for equation environments
- *Live PDF Preview*: Full document preview with bidirectional sync

* Math Syntax

** Inline Math

Inline math appears within text paragraphs and uses the following delimiters:

*** Dollar Sign Delimiter: =$...$=

The most common inline math syntax. Text between single dollar signs is rendered as mathematics.

*Example:*

The quadratic formula is $x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$ for equation $ax^2 + bx + c = 0$.


*Renders as:* The quadratic formula is x = (-b ¬± ‚àö(b¬≤ - 4ac)) / 2a for equation ax¬≤ + bx + c = 0.

*** Backslash-Parenthesis Delimiter: =\(...\)=

Alternative inline math syntax, preferred in some LaTeX style guides.

*Example:*

Einstein's mass-energy equivalence is \(E = mc^2\), where \(c\) is the speed of light.

*Renders as:* Einstein's mass-energy equivalence is E = mc¬≤, where c is the speed of light.

*** Currency Detection

The preview system intelligently avoids treating dollar amounts as math. Currency patterns like =$100= or =$5.99= are ignored.

** Display Math

Display math appears on its own line, centered and larger than inline math.

*** Double Dollar Signs: =$$...$$=

Creates unnumbered display equations.

*Example:*

$$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$$

*Renders as a centered display equation:*
‚à´‚Çã‚àû^‚àû e^(-x¬≤) dx = ‚àöœÄ

*** Backslash Brackets: =\[...\]=

Alternative display math syntax, equivalent to =$$...$$=.

*Example:*
#+BEGIN_EXAMPLE
\[
\sum_{n=1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}
\]
#+END_EXAMPLE

*Renders as a centered display equation:*
‚àë(n=1 to ‚àû) 1/n¬≤ = œÄ¬≤/6

** Math Environments

LaTeX environments provide advanced layout and automatic numbering.

*** Equation Environment

Single numbered equations with automatic numbering.

*Example:*
#+BEGIN_EXAMPLE
\begin{equation}
E = mc^2
\end{equation}
#+END_EXAMPLE

*Renders as:*
    E = mc¬≤    (1)

*** Equation* Environment (Unnumbered)

Same as =equation= but without numbering.

*Example:*
#+BEGIN_EXAMPLE
\begin{equation*}
F = ma
\end{equation*}
#+END_EXAMPLE

*** Align Environment

Multi-line equations with alignment points (=&=).

*Example:*
#+BEGIN_EXAMPLE
\begin{align}
x + y &= 5 \\
2x - y &= 1
\end{align}
#+END_EXAMPLE

*Renders as:*
    x + y  =  5    (2)
    2x - y =  1    (3)

Each line receives its own equation number.

*** Align* Environment (Unnumbered)

Multi-line alignment without equation numbers.

*Example:*
#+BEGIN_EXAMPLE
\begin{align*}
\nabla \times \mathbf{E} &= -\frac{\partial \mathbf{B}}{\partial t} \\
\nabla \times \mathbf{H} &= \mathbf{J} + \frac{\partial \mathbf{D}}{\partial t}
\end{align*}
#+END_EXAMPLE

*** Other Numbered Environments

All these environments support automatic equation numbering:

- =gather= - Multiple centered equations
- =multline= - Single equation split across lines
- =eqnarray= - Legacy alignment (prefer =align=)
- =alignat= - Alignment with explicit spacing
- =flalign= - Full-width alignment

Add an asterisk (=*=) after the environment name for the unnumbered version: =gather*=, =multline*=, etc.

*** Matrix Environments

Specialized environments for matrices and arrays:

*Example:*
#+BEGIN_EXAMPLE
$$
A = \begin{pmatrix}
a_{11} & a_{12} & a_{13} \\
a_{21} & a_{22} & a_{23} \\
a_{31} & a_{32} & a_{33}
\end{pmatrix}
$$
#+END_EXAMPLE

*Available matrix environments:*
- =matrix= - Plain matrix (no delimiters)
- =pmatrix= - Matrix with parentheses ( )
- =bmatrix= - Matrix with brackets [ ]
- =vmatrix= - Matrix with single bars | |
- =Vmatrix= - Matrix with double bars || ||
- =smallmatrix= - Compact inline matrix

* Previewing Math Fragments

** Hover Preview

To preview any LaTeX math expression:

1. Position your cursor over the math expression
2. Wait briefly or hover with your mouse
3. A tooltip appears showing the rendered equation

The preview displays:
- The rendered equation as an image (SVG or PNG)
- Equation number (if applicable)
- The original LaTeX source code

** Preview Caching

Rendered equations are cached in your VS Code global storage directory. The cache:
- Speeds up repeated hover previews
- Persists between VS Code sessions
- Automatically cleans up entries older than 7 days
- Stores separate versions for light and dark modes

** Clearing the Cache

To clear all cached equation renders:

1. Open Command Palette (=Ctrl+Shift+P= / =Cmd+Shift+P=)
2. Run: =Scimax: Clear LaTeX Cache=

To view cache statistics:

1. Open Command Palette
2. Run: =Scimax: Show LaTeX Cache Statistics=

This displays:
- Number of cached equations
- Total cache size on disk

* LaTeX Fragment Settings

** Document-Level Configuration

Add LaTeX configuration at the top of your org file using =#+LATEX_HEADER:= keywords.

*** Custom Packages

Load additional LaTeX packages for special symbols or functionality:

*Example:*
#+BEGIN_EXAMPLE
#+LATEX_HEADER: \usepackage{physics}
#+LATEX_HEADER: \usepackage{siunitx}
#+LATEX_HEADER: \usepackage{chemformula}
#+END_EXAMPLE

Now you can use commands from these packages:
- =physics=: =\grad=, =\div=, =\curl=, =\laplacian=
- =siunitx=: =\SI{10}{\meter\per\second}=
- =chemformula=: =\ch{H2O}=, =\ch{CO2}=

*** Custom Commands

Define your own LaTeX macros:

*Example:*
#+BEGIN_EXAMPLE
#+LATEX_HEADER: \newcommand{\RR}{\mathbb{R}}
#+LATEX_HEADER: \newcommand{\dd}[1]{\,\mathrm{d}#1}
#+LATEX_HEADER: \DeclareMathOperator{\Tr}{Tr}
#+END_EXAMPLE

Use in equations:
#+BEGIN_EXAMPLE
$$\int_{\RR} f(x) \dd{x} = \Tr(A)$$
#+END_EXAMPLE

*** Custom Preamble

For extensive customization, add multiple headers:

*Example:*
#+BEGIN_EXAMPLE
#+LATEX_HEADER: \usepackage{amsmath,amssymb,amsfonts}
#+LATEX_HEADER: \usepackage{mathtools}
#+LATEX_HEADER: \usepackage{bm}
#+LATEX_HEADER: \usepackage{physics}
#+LATEX_HEADER: \DeclareMathOperator{\sgn}{sgn}
#+LATEX_HEADER: \newcommand{\ve}[1]{\bm{#1}}
#+END_EXAMPLE

** VS Code Settings

Configure global LaTeX preview behavior in your settings.

*** Enable/Disable Preview

*Setting:* =scimax.latexPreview.enabled=
*Type:* boolean
*Default:* =true=

Completely enable or disable hover previews.

*Example in settings.json:*
#+BEGIN_SRC json
{
  "scimax.latexPreview.enabled": true
}
#+END_SRC

*** Cache Control

*Setting:* =scimax.latexPreview.cacheEnabled=
*Type:* boolean
*Default:* =true=

Enable or disable caching of rendered equations. Disabling may slow down previews but saves disk space.

*Example:*
#+BEGIN_SRC json
{
  "scimax.latexPreview.cacheEnabled": true
}
#+END_SRC

*** Dark Mode Awareness

*Setting:* =scimax.latexPreview.darkModeAware=
*Type:* boolean
*Default:* =true=

When enabled, equations render with white text on dark backgrounds when using dark themes, and black text for light themes.

*Example:*
#+BEGIN_SRC json
{
  "scimax.latexPreview.darkModeAware": true
}
#+END_SRC

* Common LaTeX Math Commands

** Greek Letters

*** Lowercase

| Command    | Symbol | Command     | Symbol |
|------------+--------+-------------+--------|
| =\alpha=   | Œ±      | =\nu=       | ŒΩ      |
| =\beta=    | Œ≤      | =\xi=       | Œæ      |
| =\gamma=   | Œ≥      | =\pi=       | œÄ      |
| =\delta=   | Œ¥      | =\rho=      | œÅ      |
| =\epsilon= | Œµ      | =\sigma=    | œÉ      |
| =\zeta=    | Œ∂      | =\tau=      | œÑ      |
| =\eta=     | Œ∑      | =\upsilon=  | œÖ      |
| =\theta=   | Œ∏      | =\phi=      | œÜ      |
| =\iota=    | Œπ      | =\chi=      | œá      |
| =\kappa=   | Œ∫      | =\psi=      | œà      |
| =\lambda=  | Œª      | =\omega=    | œâ      |
| =\mu=      | Œº      |             |        |

*** Uppercase

| Command    | Symbol | Command   | Symbol |
|------------+--------+-----------+--------|
| =\Gamma=   | Œì      | =\Xi=     | Œû      |
| =\Delta=   | Œî      | =\Pi=     | Œ†      |
| =\Theta=   | Œò      | =\Sigma=  | Œ£      |
| =\Lambda=  | Œõ      | =\Phi=    | Œ¶      |
| =\Upsilon= | Œ•      | =\Psi=    | Œ®      |
| =\Omega=   | Œ©      |           |        |

** Math Operators

| Command      | Output                    | Description              |
|--------------+---------------------------+--------------------------|
| =\frac{a}{b}=  | a/b                       | Fraction                 |
| =\sqrt{x}=     | ‚àöx                        | Square root              |
| =\sqrt[n]{x}=  | ‚Åø‚àöx                       | nth root                 |
| =x^{2}=        | x¬≤                        | Superscript (power)      |
| =x_{i}=        | x·µ¢                        | Subscript                |
| =\int=         | ‚à´                         | Integral                 |
| =\sum=         | ‚àë                         | Summation                |
| =\prod=        | ‚àè                         | Product                  |
| =\lim=         | lim                       | Limit                    |
| =\partial=     | ‚àÇ                         | Partial derivative       |
| =\nabla=       | ‚àá                         | Nabla (gradient)         |
| =\infty=       | ‚àû                         | Infinity                 |

** Relations and Operators

| Command   | Symbol | Command   | Symbol |
|-----------+--------+-----------+--------|
| =\leq=    | ‚â§      | =\geq=    | ‚â•      |
| =\neq=    | ‚â†      | =\approx= | ‚âà      |
| =\equiv=  | ‚â°      | =\sim=    | ‚àº      |
| =\propto= | ‚àù      | =\in=     | ‚àà      |
| =\notin=  | ‚àâ      | =\subset= | ‚äÇ      |
| =\supset= | ‚äÉ      | =\cup=    | ‚à™      |
| =\cap=    | ‚à©      | =\wedge=  | ‚àß      |
| =\vee=    | ‚à®      | =\neg=    | ¬¨      |
| =\times=  | √ó      | =\div=    | √∑      |
| =\pm=     | ¬±      | =\mp=     | ‚àì      |
| =\cdot=   | ¬∑      | =\circ=   | ‚àò      |

** Arrows

| Command          | Symbol | Description        |
|------------------+--------+--------------------|
| =\rightarrow=    | ‚Üí      | Right arrow        |
| =\leftarrow=     | ‚Üê      | Left arrow         |
| =\Rightarrow=    | ‚áí      | Implies            |
| =\Leftarrow=     | ‚áê      | Implied by         |
| =\Leftrightarrow= | ‚áî      | If and only if     |
| =\uparrow=       | ‚Üë      | Up arrow           |
| =\downarrow=     | ‚Üì      | Down arrow         |
| =\to=            | ‚Üí      | Alternative for ‚Üí |
| =\mapsto=        | ‚Ü¶      | Maps to            |

** Special Symbols

| Command       | Symbol | Description              |
|---------------+--------+--------------------------|
| =\mathbb{R}=  | ‚Ñù      | Real numbers             |
| =\mathbb{N}=  | ‚Ñï      | Natural numbers          |
| =\mathbb{Z}=  | ‚Ñ§      | Integers                 |
| =\mathbb{Q}=  | ‚Ñö      | Rational numbers         |
| =\mathbb{C}=  | ‚ÑÇ      | Complex numbers          |
| =\emptyset=   | ‚àÖ      | Empty set                |
| =\forall=     | ‚àÄ      | For all                  |
| =\exists=     | ‚àÉ      | There exists             |
| =\ell=        | ‚Ñì      | Script lowercase L       |
| =\hbar=       | ‚Ñè      | Reduced Planck constant  |

** Delimiters

| Command            | Output        | Description                 |
|--------------------+---------------+-----------------------------|
| =\left( \right)=   | ( )           | Auto-sized parentheses      |
| =\left[ \right]=   | [ ]           | Auto-sized brackets         |
| =\left\{ \right\}= | { }           | Auto-sized braces           |
| =\left| \right|=   | \vert \vert   | Auto-sized vertical bars    |
| =\langle \rangle=  | ‚ü® ‚ü©           | Angle brackets              |
| =\lfloor \rfloor=  | ‚åä ‚åã           | Floor function              |
| =\lceil \rceil=    | ‚åà ‚åâ           | Ceiling function            |

** Accents and Decorations

| Command        | Example    | Description          |
|----------------+------------+----------------------|
| =\hat{x}=      | xÃÇ          | Hat accent           |
| =\bar{x}=      | xÃÑ          | Bar (mean)           |
| =\tilde{x}=    | xÃÉ          | Tilde                |
| =\dot{x}=      | ·∫ã          | Dot (derivative)     |
| =\ddot{x}=     | ·∫ç          | Double dot           |
| =\vec{x}=      | x‚Éó          | Vector arrow         |
| =\overline{AB}= | ABÃÑ         | Overline             |
| =\underline{x}= | xÃ≤          | Underline            |

* Example Equations

** Calculus

*Derivative definition:*
#+BEGIN_EXAMPLE
$$f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}$$
#+END_EXAMPLE

*Fundamental theorem of calculus:*
#+BEGIN_EXAMPLE
$$\int_a^b f'(x) \,dx = f(b) - f(a)$$
#+END_EXAMPLE

*Integration by parts:*
#+BEGIN_EXAMPLE
$$\int u \,dv = uv - \int v \,du$$
#+END_EXAMPLE

** Linear Algebra

*Matrix multiplication:*
#+BEGIN_EXAMPLE
$$
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
=
\begin{pmatrix}
ax + by \\
cx + dy
\end{pmatrix}
$$
#+END_EXAMPLE

*Determinant:*
#+BEGIN_EXAMPLE
$$\det(A) = \begin{vmatrix} a & b \\ c & d \end{vmatrix} = ad - bc$$
#+END_EXAMPLE

*Eigenvalue equation:*
#+BEGIN_EXAMPLE
$$A\mathbf{v} = \lambda\mathbf{v}$$
#+END_EXAMPLE

** Physics

*Schr√∂dinger equation:*
#+BEGIN_EXAMPLE
$$i\hbar \frac{\partial}{\partial t}\Psi(\mathbf{r},t) = \hat{H}\Psi(\mathbf{r},t)$$
#+END_EXAMPLE

*Maxwell's equations:*
#+BEGIN_EXAMPLE
\begin{align*}
\nabla \cdot \mathbf{E} &= \frac{\rho}{\epsilon_0} \\
\nabla \cdot \mathbf{B} &= 0 \\
\nabla \times \mathbf{E} &= -\frac{\partial \mathbf{B}}{\partial t} \\
\nabla \times \mathbf{B} &= \mu_0\mathbf{J} + \mu_0\epsilon_0\frac{\partial \mathbf{E}}{\partial t}
\end{align*}
#+END_EXAMPLE

** Statistics

*Normal distribution:*
#+BEGIN_EXAMPLE
$$f(x) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)$$
#+END_EXAMPLE

*Bayes' theorem:*
#+BEGIN_EXAMPLE
$$P(A|B) = \frac{P(B|A)P(A)}{P(B)}$$
#+END_EXAMPLE

** Computer Science

*Big-O notation:*
#+BEGIN_EXAMPLE
$$T(n) = O(n\log n)$$
#+END_EXAMPLE

*Recurrence relation:*
#+BEGIN_EXAMPLE
$$T(n) = 2T\left(\frac{n}{2}\right) + O(n)$$
#+END_EXAMPLE

* Troubleshooting Rendering Issues

** Common Problems and Solutions

*** Problem: "pdflatex not found" Error

*Cause:* LaTeX is not installed on your system.

*Solution:*
Install a LaTeX distribution:

- *Linux*: =sudo apt-get install texlive-full=
- *macOS*: Install MacTeX from https://tug.org/mactex/
- *Windows*: Install MiKTeX from https://miktex.org/ or TeX Live

After installation, restart VS Code.

*** Problem: Equations Not Rendering on Hover

*Possible causes and solutions:*

1. *LaTeX preview disabled*
   - Open Settings (=Ctrl+,=)
   - Search for "scimax.latexPreview.enabled"
   - Ensure it is set to =true=

2. *Syntax error in equation*
   - Hover shows error message
   - Check the LaTeX source code shown in the tooltip
   - Common errors: unmatched braces, unknown commands, missing packages

3. *Missing LaTeX package*
   - Add required package via =#+LATEX_HEADER:=
   - Example: =#+LATEX_HEADER: \usepackage{physics}=

*** Problem: Slow Hover Response

*Solutions:*

1. *Enable caching* (if disabled):
   #+BEGIN_SRC json
   {
     "scimax.latexPreview.cacheEnabled": true
   }
   #+END_SRC

2. *Clear corrupted cache*:
   - Command Palette ‚Üí "Scimax: Clear LaTeX Cache"

3. *Simplify complex equations*:
   - Break very long equations into smaller parts
   - Use fewer custom packages

*** Problem: Rendering Wrong in Dark Mode

*Solution:*

Enable dark mode awareness:
#+BEGIN_SRC json
{
  "scimax.latexPreview.darkModeAware": true
}
#+END_SRC

The equation will automatically render with appropriate colors for your theme.

*** Problem: Equation Numbers Wrong

*Cause:* Counter cache may be stale after editing.

*Solution:*
The counter cache automatically invalidates when you edit the document. If numbers still appear incorrect, save the file and hover again.

*** Problem: dvisvgm Not Available

*Error message:* "dvisvgm not found. SVG output will not be available, using PNG fallback."

*Impact:* Equations render as PNG instead of SVG (slightly lower quality when zooming).

*Solution:*
Install dvisvgm (usually included with full LaTeX distributions):
- =sudo apt-get install texlive-binaries= (Linux)
- Included with MacTeX and full TeX Live installations

*** Problem: Currency Detected as Math

*Example:* =$100= is rendering as math instead of currency.

*Solution:*
This should not happen as the preview system detects dollar amounts starting with numbers. If it does occur:
- Use =\$100= to escape the dollar sign
- Or use proper currency notation outside of math mode

* Integration with Export

** HTML Export

When exporting to HTML, LaTeX math is rendered using MathJax:

1. Inline math: =$E = mc^2$= ‚Üí Renders with MathJax in browser
2. Display math: =$$...$$= ‚Üí Centered equation in HTML
3. Environments: =\begin{align}...\end{align}= ‚Üí Properly formatted

The export includes MathJax CDN automatically, so equations render perfectly in web browsers.

** LaTeX/PDF Export

When exporting to LaTeX or PDF:

1. Math expressions are passed through unchanged
2. =#+LATEX_HEADER:= settings are included in preamble
3. Equation numbering preserved
4. All environments work natively

** Export and Preview Consistency

What you see in hover preview should match the exported output, but note:

- *HTML export*: Uses MathJax (may look slightly different from LaTeX preview)
- *PDF export*: Uses your LaTeX compiler (exact match with preview)
- *Font differences*: Preview uses default LaTeX fonts; exports may use custom fonts

* Commands and Keybindings

** Preview Commands

| Command                             | Description                        | Keybinding                 |
|-------------------------------------+------------------------------------+----------------------------|
| Scimax: Clear LaTeX Cache           | Clear all cached equation renders  | None (use Command Palette) |
| Scimax: Show LaTeX Cache Statistics | Display cache size and entry count | None                       |

** Live PDF Preview Commands

| Command                             | Description                       | Keybinding        |
|-------------------------------------+-----------------------------------+-------------------|
| Scimax: Open LaTeX Live Preview     | Open live PDF preview of document | Ctrl+C Ctrl+E L V |
| Scimax: Sync PDF to Cursor Position | Jump to cursor location in PDF    | Ctrl+C Ctrl+E L S |
| Scimax: Rebuild PDF                 | Manually trigger PDF rebuild      | None              |
| Scimax: Show LaTeX Build Output     | Show compiler output and errors   | None              |

** Markup Commands

| Command                             | Description                 | Keybinding |
|-------------------------------------+-----------------------------+------------|
| Scimax: LaTeX Math (Markup)         | Insert inline math $...$    | None       |
| Scimax: LaTeX Display Math (Markup) | Insert display math $$...$$ | None       |

** Using Commands

1. *Via Command Palette*:
   - Press =Ctrl+Shift+P= (=Cmd+Shift+P= on macOS)
   - Type "Scimax: Clear LaTeX Cache" (or any command name)
   - Press Enter

2. *Via Keybinding*:
   - For commands with keybindings, simply press the key combination
   - Example: =Ctrl+C Ctrl+E L V= opens live preview

** Custom Keybindings

To add custom keybindings for commands without defaults:

1. Open Keyboard Shortcuts (=Ctrl+K Ctrl+S=)
2. Search for the command (e.g., "Clear LaTeX Cache")
3. Click the + icon to add a keybinding
4. Press your desired key combination

*Example keybindings.json:*
#+BEGIN_SRC json
[
  {
    "key": "ctrl+alt+l",
    "command": "scimax.clearLatexCache",
    "when": "editorLangId == 'org'"
  }
]
#+END_SRC

* Advanced Topics

** Multi-line Equations

Use =\\= to break equations across multiple lines within display math:

#+BEGIN_EXAMPLE
$$
f(x) = a_0 + a_1 x + a_2 x^2 + \cdots \\
     = \sum_{n=0}^{\infty} a_n x^n
$$
#+END_EXAMPLE

** Aligned Equations at Specific Points

Use =&= in =align= environments to specify alignment points:

#+BEGIN_EXAMPLE
\begin{align*}
x &= r\cos\theta \\
y &= r\sin\theta
\end{align*}
#+END_EXAMPLE

The =&= symbols align vertically.

** Cases and Piecewise Functions

Use the =cases= environment:

#+BEGIN_EXAMPLE
$$
f(x) = \begin{cases}
x^2 & \text{if } x \geq 0 \\
-x^2 & \text{if } x < 0
\end{cases}
$$
#+END_EXAMPLE

** Chemical Formulas

With the =chemformula= package:

#+BEGIN_EXAMPLE
#+LATEX_HEADER: \usepackage{chemformula}

The reaction is \ch{2 H2 + O2 -> 2 H2O}.
#+END_EXAMPLE

** Physics Notation

With the =physics= package:

#+BEGIN_EXAMPLE
#+LATEX_HEADER: \usepackage{physics}

$$\dv{f}{x} = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}$$

$$\grad V = \left(\pdv{V}{x}, \pdv{V}{y}, \pdv{V}{z}\right)$$
#+END_EXAMPLE

** SI Units

With the =siunitx= package:

#+BEGIN_EXAMPLE
#+LATEX_HEADER: \usepackage{siunitx}

The speed is \SI{3e8}{\meter\per\second}.
#+END_EXAMPLE

* Best Practices

** Document Organization

1. *Place all =#+LATEX_HEADER:= lines at the top* of your org file, before the first heading
2. *Group related packages* together with comments
3. *Define custom commands* early for use throughout the document

*Example:*
#+BEGIN_EXAMPLE
#+TITLE: Research Notes
#+AUTHOR: Your Name
#+DATE: 2026-01-13

# Standard math packages
#+LATEX_HEADER: \usepackage{amsmath,amssymb,amsfonts}
#+LATEX_HEADER: \usepackage{mathtools}

# Physics
#+LATEX_HEADER: \usepackage{physics}

# Custom commands
#+LATEX_HEADER: \newcommand{\RR}{\mathbb{R}}
#+LATEX_HEADER: \newcommand{\dd}[1]{\,\mathrm{d}#1}

* First Section
#+END_EXAMPLE

** Writing Maintainable Math

1. *Use meaningful variable names* in comments:
   #+BEGIN_EXAMPLE
   $$v = v_0 + at$$ # velocity equation
   #+END_EXAMPLE

2. *Break complex equations* into multiple lines:
   #+BEGIN_EXAMPLE
   \begin{align*}
   E_{\text{total}} &= E_{\text{kinetic}} + E_{\text{potential}} \\
                    &= \frac{1}{2}mv^2 + mgh
   \end{align*}
   #+END_EXAMPLE

3. *Use consistent notation* throughout your document

4. *Define reusable commands* for frequently used symbols

** Performance Tips

1. *Keep custom packages minimal* - only load what you need
2. *Use caching* (keep =scimax.latexPreview.cacheEnabled= true)
3. *Simplify very complex equations* - LaTeX compilation can be slow for intricate formulas
4. *Avoid excessive hover* - let the cache build up naturally

** Accessibility

When sharing documents:

1. *Provide text descriptions* for complex equations
2. *Export to HTML* for web accessibility (MathJax is screen-reader friendly)
3. *Use semantic math* rather than visual formatting

* Quick Reference Card

** Math Delimiters

| Type          | Syntax                    | Description           |
|---------------+---------------------------+-----------------------|
| Inline        | =$...$=                   | Dollar signs          |
| Inline        | =\(...\)=                 | Backslash parens      |
| Display       | =$$...$$=                 | Double dollar         |
| Display       | =\[...\]=                 | Backslash brackets    |
| Environment   | =\begin{...}\end{...}=    | LaTeX environment     |

** Common Environments

| Environment     | Numbered | Description                |
|-----------------+----------+----------------------------|
| =equation=      | Yes      | Single equation            |
| =equation*=     | No       | Single equation            |
| =align=         | Yes      | Multi-line aligned         |
| =align*=        | No       | Multi-line aligned         |
| =gather=        | Yes      | Multi-line centered        |
| =gather*=       | No       | Multi-line centered        |
| =matrix=        | N/A      | Plain matrix               |
| =pmatrix=       | N/A      | Matrix with ( )            |
| =bmatrix=       | N/A      | Matrix with [ ]            |

** Essential Commands

| Category      | Examples                                           |
|---------------+----------------------------------------------------|
| Greek         | =\alpha \beta \gamma \delta \lambda \sigma \omega= |
| Operators     | =\frac \sqrt \sum \int \prod \lim=                 |
| Relations     | =\leq \geq \neq \approx \equiv \in=                |
| Arrows        | =\to \rightarrow \Rightarrow \Leftrightarrow=      |
| Sets          | =\mathbb{R} \mathbb{N} \mathbb{Z} \emptyset=       |
| Logic         | =\forall \exists \wedge \vee \neg=                 |
| Calculus      | =\partial \nabla \infty=                           |
| Delimiters    | =\left( \right) \left[ \right] \left\{ \right\}=   |

** Keybindings

| Action                | Keybinding          |
|-----------------------+---------------------|
| Open live preview     | =C-c C-e l v=       |
| Forward sync          | =C-c C-e l s=       |
| Export dispatcher     | =C-c C-e=           |

** Settings

| Setting                            | Default | Description              |
|------------------------------------+---------+--------------------------|
| =scimax.latexPreview.enabled=      | =true=  | Enable hover previews    |
| =scimax.latexPreview.cacheEnabled= | =true=  | Cache rendered equations |
| =scimax.latexPreview.darkModeAware= | =true= | Adapt to theme           |

* Additional Resources

** LaTeX Documentation

- LaTeX Math Wiki: https://en.wikibooks.org/wiki/LaTeX/Mathematics
- Comprehensive LaTeX Symbol List: http://tug.ctan.org/info/symbols/comprehensive/symbols-a4.pdf
- Detexify (draw symbols): https://detexify.kirelabs.org/classify.html

** Package Documentation

- =amsmath=: https://ctan.org/pkg/amsmath
- =physics=: https://ctan.org/pkg/physics
- =siunitx=: https://ctan.org/pkg/siunitx
- =chemformula=: https://ctan.org/pkg/chemformula

** Org-Mode Export

- Org-Mode Manual: https://orgmode.org/manual/
- LaTeX Export: https://orgmode.org/manual/LaTeX-Export.html
- Math Formatting: https://orgmode.org/manual/LaTeX-fragments.html

** Scimax VS Code Documentation

- Export System: =docs/export.org=
- Source Blocks: =docs/source-blocks.org=
- Configuration: =docs/configuration.org=

* Navigation

- Previous: [[file:export.org][Export]]
- Next: [[file:image-overlays.org][Image Overlays]]
