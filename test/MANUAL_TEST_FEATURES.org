#+TITLE: Scimax VSCode Feature Testing Guide
#+AUTHOR: Feature Testing
#+DATE: 2026-01-13

This file contains manual tests for the features added in this session:
1. Native Org Agenda
2. Table Formulas (#+TBLFM:)
3. Capture Templates
4. Image Overlays (from previous session)

* Native Org Agenda Testing
:PROPERTIES:
:CUSTOM_ID: agenda-testing
:END:

** Test 1: Agenda View
:PROPERTIES:
:CUSTOM_ID: agenda-view
:END:

*** Instructions:
1. Open Command Palette (Ctrl+Shift+P / Cmd+Shift+P)
2. Search for "Scimax: Show Agenda"
3. The sidebar should show the Agenda panel

*** Expected:
- Agenda tree view appears in the sidebar
- Items grouped by date
- Tasks from org files in workspace displayed

** Test 2: TODO List View

*** Instructions:
1. Command Palette -> "Scimax: Show TODO List"
2. Or click on the agenda view and switch to TODO view

*** Expected:
- All TODO items displayed
- Can group by priority, category, or TODO state

** TODO Test Task 1 :test:
DEADLINE: <2026-01-15 Wed>
This is a test task for agenda testing.

** TODO Test Task 2 [#A] :urgent:
SCHEDULED: <2026-01-14 Tue>
High priority test task.

** DONE Completed Test Task :done:
CLOSED: [2026-01-12 Sun 10:00]
This task is completed.

** Test 3: Filtering

*** Instructions:
1. Command Palette -> "Scimax: Filter Agenda by Tag"
2. Enter "test" as the tag

*** Expected:
- Only items with :test: tag shown
- Filter persists until cleared

* Table Formula Testing
:PROPERTIES:
:CUSTOM_ID: table-formulas
:END:

** Test 1: Basic Column Formulas

*** Instructions:
1. Place cursor in the table below
2. Run "Scimax: Recalculate Table Formulas" (Ctrl+C *)
3. The third column should calculate as first + second

*** Table:
| Item   | Price | Quantity | Total |
|--------+-------+----------+-------|
| Apple  | 1.50  | 3        | 4.5   |
| Banana | 0.75  | 6        | 4.5   |
| Orange | 2.00  | 2        | 4     |
#+TBLFM: $4=$2*$3

*** Expected:
- After recalculation:
  - Apple Total: 4.50
  - Banana Total: 4.50
  - Orange Total: 4.00

** Test 2: Spreadsheet Functions (vsum, vmean)

*** Instructions:
1. Recalculate the table below (Ctrl+C *)
2. Check that totals and averages are calculated

*** Table with Functions:
| Category | Q1 | Q2 | Q3 | Q4 | Total | Average |
|----------+----+----+----+----+-------+---------|
| Sales    | 10 | 20 | 30 | 40 | 100   | 25      |
| Support  | 5  | 10 | 15 | 20 | 50    | 12.5    |
| R&D      | 15 | 25 | 35 | 45 | 120   | 30      |
#+TBLFM: $6=vsum($2..$5)::$7=vmean($2..$5)

*** Expected:
- Sales Total: 100, Average: 25
- Support Total: 50, Average: 12.5
- R&D Total: 120, Average: 30

** Test 3: Field References (@row$col)

*** Instructions:
1. Recalculate the table below
2. Cell @4$3 should contain the sum of first 3 rows in column 2

*** Table with Field References:
| ID | Value | Running Sum |
|----+-------+-------------|
| 1  | 10    | 10          |
| 2  | 20    | 30          |
| 3  | 30    | 60          |
#+TBLFM: @2$3=$2::@3$3=@2$3+$2::@4$3=vsum(@2$2..@4$2)

*** Expected:
- Row 2 Running Sum: 10
- Row 3 Running Sum: 30
- Row 4 Running Sum: 60

** Test 4: Mathematical Expressions

*** Instructions:
1. Recalculate this table to verify math operations

*** Math Table:
| A | B | A+B | A*B | A/B  | A^2 |
|---+---+-----+-----+------+-----|
| 3 | 4 | 7   | 12  | 0.75 | 9   |
| 5 | 2 | 7   | 10  | 2.50 | 25  |
| 8 | 3 | 11  | 24  | 2.67 | 64  |
#+TBLFM: $3=$1+$2::$4=$1*$2::$5=$1/$2;%.2f::$6=$1**2

*** Expected:
- Row 1: 7, 12, 0.75, 9
- Row 2: 7, 10, 2.50, 25
- Row 3: 11, 24, 2.67, 64

** Test 5: Insert Formula Commands

*** Instructions:
1. Place cursor in a table
2. Run "Scimax: Insert Column Formula"
3. Enter a formula like "$4=$2+$3"
4. Check that #+TBLFM: line is added/updated

*** Expected:
- Formula line appears below table
- Formula syntax validated

* Capture Template Testing
:PROPERTIES:
:CUSTOM_ID: capture-testing
:END:

** Test 1: Quick Capture (TODO)

*** Instructions:
1. Run "Scimax: Quick Capture TODO" (Ctrl+C T)
2. Enter a task title when prompted
3. Check that TODO is created

*** Expected:
- Quick pick prompt appears
- After entering text, a new TODO item is created
- Default file ~/org/notes.org should contain the capture

** Test 2: Quick Capture (Note)

*** Instructions:
1. Run "Scimax: Quick Capture Note"
2. Enter a note title
3. Check note is added

*** Expected:
- Note entry created with timestamp

** Test 3: Capture Template Picker

*** Instructions:
1. Run "Scimax: Capture" (Ctrl+C C)
2. If no templates configured, you'll see default templates
3. Select a template
4. Fill in any prompts

*** Expected:
- Template picker shows available templates
- Template expansion works with placeholders

** Test 4: Create Custom Template

*** Instructions:
1. Run "Scimax: Create Capture Template"
2. Follow the prompts:
   - Key: m (for meetings)
   - Name: Meeting Notes
   - Type: entry
   - File: ~/org/meetings.org
   - Headline: (leave empty or specify)
   - Datetree: No
   - Template: Enter your template text

*** Expected:
- Template is created and saved to settings
- New template appears in capture picker

** Test 5: Template with Placeholders

*** Instructions:
1. Create or use a template with placeholders:
   - %^{prompt} - Interactive prompt
   - %t - Current timestamp
   - %T - Active timestamp
   - %i - Initial content (selection)
   - %a - Annotation (link to where capture was invoked)
   - %U - Inactive timestamp

*** Test Template Example:
A template configured as:
"* %^{Topic}\n:PROPERTIES:\n:CREATED: %U\n:END:\n%i"

*** Expected:
- Prompts appear for %^{...} placeholders
- Timestamps inserted correctly
- Selection captured with %i

* Image Overlay Testing
:PROPERTIES:
:CUSTOM_ID: image-overlays
:END:

** Test 1: Toggle Overlays

*** Instructions:
1. Have an org file with image links
2. Run "Scimax: Toggle Image Overlays"

*** Expected:
- Small thumbnails appear in the gutter or inline
- Hovering shows larger preview

** Test 2: Image Link Examples

[[./test-image.png]]

[[https://via.placeholder.com/150]]

[[file:./screenshots/example.png]]

** Test 3: Overlay Settings

*** Instructions:
1. Open VS Code Settings
2. Search for "scimax.imageOverlays"
3. Try adjusting:
   - maxWidth/maxHeight
   - renderMode (gutter, after, both)
   - onlyWhenCursorNotInLink

*** Expected:
- Settings changes apply immediately
- Different render modes show images differently

* Agenda Configuration
:PROPERTIES:
:CUSTOM_ID: agenda-config
:END:

** Configuring Agenda Files

*** Instructions:
1. Open VS Code Settings
2. Search for "scimax.agenda.files"
3. Add paths to your org files:
   - "~/org/*.org"
   - "./project/**/*.org"
4. Run "Scimax: Refresh Agenda"

*** Expected:
- Agenda scans specified files
- Items from those files appear in agenda view

** Configuration Options:

| Setting                       | Description                 | Default             |
|-------------------------------+-----------------------------+---------------------|
| scimax.agenda.files           | Glob patterns for org files | []                  |
| scimax.agenda.excludePatterns | Patterns to exclude         | ["archive"]         |
| scimax.agenda.defaultSpan     | Days to show in agenda      | 7                   |
| scimax.agenda.showDone        | Show completed tasks        | false               |
| scimax.agenda.todoStates      | Active TODO keywords        | TODO, NEXT, WAITING |
| scimax.agenda.doneStates      | Completed keywords          | DONE, CANCELLED     |

* Capture Configuration
:PROPERTIES:
:CUSTOM_ID: capture-config
:END:

** Configuring Capture Templates

*** Settings JSON Example:
#+begin_src json
{
  "scimax.capture.templates": [
    {
      "key": "t",
      "name": "Task",
      "type": "entry",
      "file": "~/org/tasks.org",
      "headline": "Inbox",
      "template": "* TODO %^{Task}\nSCHEDULED: %t\n%i"
    },
    {
      "key": "n",
      "name": "Note",
      "type": "entry",
      "file": "~/org/notes.org",
      "datetree": true,
      "template": "* %^{Title}\n%U\n%i"
    },
    {
      "key": "j",
      "name": "Journal",
      "type": "entry",
      "file": "~/org/journal.org",
      "datetree": true,
      "template": "* %U\n%^{Entry}"
    }
  ],
  "scimax.capture.defaultFile": "~/org/inbox.org",
  "scimax.capture.autoSave": true
}
#+end_src

* Troubleshooting
:PROPERTIES:
:CUSTOM_ID: troubleshooting
:END:

** Common Issues

*** Agenda not showing items
- Check scimax.agenda.files setting
- Ensure files exist and are valid org files
- Run "Scimax: Refresh Agenda"

*** Table formulas not calculating
- Ensure #+TBLFM: line is directly after the table
- Check formula syntax (column refs start at $1)
- Look for error messages in the output

*** Capture not saving
- Check scimax.capture.defaultFile exists or can be created
- Ensure write permissions to target directory
- Check scimax.capture.autoSave setting

*** Image overlays not appearing
- Check scimax.imageOverlays.enabled setting
- Ensure image paths are valid
- Try "Scimax: Refresh Image Overlays"

* Test Summary Checklist

** Agenda
- [ ] Agenda view opens in sidebar
- [ ] TODO list view works
- [ ] Grouping by date/category/priority works
- [ ] Filtering by tag works
- [ ] Clicking item opens file at location
- [ ] Refresh command works

** Table Formulas
- [ ] Column formulas ($n) calculate correctly
- [ ] Field references (@r$c) work
- [ ] Range references (@r1$c..@r2$c) work
- [ ] vsum function works
- [ ] vmean function works
- [ ] vmin, vmax functions work
- [ ] Mathematical expressions evaluate
- [ ] Insert formula command works
- [ ] Formula help command shows info

** Capture
- [ ] Quick TODO capture works
- [ ] Quick Note capture works
- [ ] Template picker shows templates
- [ ] Placeholders expand correctly
- [ ] File targeting works
- [ ] Headline targeting works
- [ ] Datetree targeting works
- [ ] Create template command works
- [ ] Auto-save works

** Image Overlays
- [ ] Toggle command works
- [ ] Gutter thumbnails appear
- [ ] Inline decorations appear (if configured)
- [ ] Hover preview shows larger image
- [ ] Cache stats command works
- [ ] Clear cache command works
